ETRG89 = [
3758586.667529 2892313.553893;
3762536.694838 2891724.348454;
3757037.727318 2888916.409518;
3762486.974734 2887876.527661;
];

WSG84 = [
2.3186303 48.8798445;
2.373047  48.8782638;
2.3023467 48.8480258;
2.3776817 48.8438192;
];

A = zeros(8, 9);

for i=1:4
    A((i-1)*2+1, :) = [ WSG84(i, 1) WSG84(i, 2) 1 0 0 0 -ETRG89(i, 1)*WSG84(i, 1) -ETRG89(i, 1)*WSG84(i, 2) -ETRG89(i, 1) ];
    A((i-1)*2+2, :) = [ 0 0 0 WSG84(i, 1) WSG84(i, 2) 1 -ETRG89(i, 2)*WSG84(i, 1) -ETRG89(i, 2)*WSG84(i, 2) -ETRG89(i, 2) ];
end

[U S V] = svd(A);

format long
H = reshape(V(:,end), 3, 3)'
